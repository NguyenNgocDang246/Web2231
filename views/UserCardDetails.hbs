<style>
    /* Căn giữa checkbox trong bảng */
    .checkbox-center {
        text-align: center;
    }
</style>

{{> Nav user=user}}

<!-- Checkout Section -->
<section class="py-5">
    <div class="container">
        <div class="row g-4">
            <!-- Order Summary (Product Info) -->
            <div class="col-md-8">
                <div class="card">
                    <div class="card-body">
                        <h2 class="card-title">Order Summary</h2>
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>Product</th>
                                    <th>Quantity</th>
                                    <th>Price</th>
                                    <th class="checkbox-center">Select to Buy</th>
                                </tr>
                            </thead>
                            <tbody id="orderSummary">
                                <!-- Products will be populated here -->
                            </tbody>
                        </table>
                        <h4 class="fw-bold">Total: $<span id="totalPrice">0.00</span></h4>
                    </div>
                </div>
            </div>

            <!-- Billing and Payment Information -->
            <div class="col-md-4">
                <div class="card">
                    <div class="card-body">
                        <h2 class="card-title">Billing Information</h2>
                        <form id="paymentForm">
                            <!-- Name -->
                            <div class="mb-3">
                                <label for="fullName" class="form-label">Full Name</label>
                                <input type="text" class="form-control" id="fullName" required>
                            </div>
                            <!-- Address -->
                            <div class="mb-3">
                                <label for="address" class="form-label">Shipping Address</label>
                                <input type="text" class="form-control" id="address" required>
                            </div>
                            <!-- Payment Method -->
                            <div class="mb-3">
                                <label for="paymentMethod" class="form-label">Payment Method</label>
                                <select class="form-select" id="paymentMethod" required>
                                    <option value="creditCard">Credit Card</option>
                                    <option value="paypal">PayPal</option>
                                </select>
                            </div>
                            <!-- Submit Button -->
                            <button type="submit" class="btn btn-success w-100">Confirm Purchase</button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Footer -->
<footer class="bg-dark text-white py-3">
    <div class="container text-center">
        <p>&copy; 2024 Clothing Shop. All Rights Reserved.</p>
    </div>
</footer>

<script>
    // Mock data (can be dynamically loaded in a real app)
    const products = [
        { id: 1, name: "T-Shirt", quantity: 1, price: 25.00 },
        { id: 2, name: "Jeans", quantity: 2, price: 40.00 },
        { id: 3, name: "Sneakers", quantity: 1, price: 60.00 }
    ];

    // Function to populate order summary dynamically
    function populateOrderSummary() {
        const orderSummary = document.getElementById('orderSummary');
        let totalPrice = 0;
        orderSummary.innerHTML = '';  // Clear any previous content

        products.forEach(product => {
            const row = document.createElement('tr');
            row.innerHTML = `
                    <td>${product.name}</td>
                    <td>${product.quantity}</td>
                    <td>$${product.price.toFixed(2)}</td>
                    <td class="checkbox-center"><input type="checkbox" class="product-checkbox" data-id="${product.id}" data-price="${product.price}" ${product.selected ? 'checked' : ''}></td>
                `;
            orderSummary.appendChild(row);

            // Calculate the total price based on selected items
            if (product.selected) {
                totalPrice += product.price * product.quantity;
            }
        });

        document.getElementById('totalPrice').textContent = totalPrice.toFixed(2);
    }

    // Event listener for checkbox change
    document.getElementById('orderSummary').addEventListener('change', function (event) {
        if (event.target.classList.contains('product-checkbox')) {
            const productId = event.target.getAttribute('data-id');
            const product = products.find(p => p.id == productId);
            product.selected = event.target.checked;
            populateOrderSummary();  // Recalculate total price
        }
    });

    // Handle form submission
    document.getElementById('paymentForm').addEventListener('submit', function (event) {
        event.preventDefault();  // Prevent form from submitting
        alert('Thank you for your purchase! Your order has been confirmed.');
    });

    // Initial population of the order summary
    populateOrderSummary();
</script>